<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìƒí’ˆ ìƒì„¸ | WeNers</title>

<!-- ğŸ”¥ ë°˜ë“œì‹œ ì¡´ì¬í•´ì•¼ í•¨ (supabase ì •ì˜ ì˜¤ë¥˜ í•´ê²°) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
    body { font-family: Arial; max-width:700px; margin:30px auto; }
    h1 { font-size:28px; margin-bottom:20px; }
    .box{border:1px solid #ddd;padding:18px;border-radius:10px;margin-top:20px;}
    img{width:100%;max-height:300px;border-radius:10px;object-fit:cover;}
    .label{font-weight:bold;}
    .btn{background:black;color:white;padding:10px 16px;margin-top:14px;border-radius:8px;display:inline-block;cursor:pointer;}
    .btn:hover{opacity:.8;}
</style>
</head>
<body>

<h1>ğŸ›’ ìƒí’ˆ ìƒì„¸í˜ì´ì§€</h1>
<div id="view">â³ ë¡œë”©ì¤‘...</div>

<script>
// ==========================================================
// ğŸ”¥ Supabase ì´ˆê¸°í™” (ìˆœì„œ ë¬¸ì œ â†’ body ë‚´ë¶€ ìœ„ì¹˜ë¡œ ê³ ì •ë¨)
// ==========================================================
const supabase = window.supabase.createClient(
    "https://wfgqdswcdwdvfaqwejmd.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndmZ3Fkc3djZHdkdmZhcXdlam1kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4MDc2NjcsImV4cCI6MjA4MDM4MzY2N30.Jb9nqalTEPp3Grwy3lnLczl6cE7gTSsK4Ol3hXGdl1Q"
);

// ==========================================================
// URLì—ì„œ product ID ì¶”ì¶œ
// ==========================================================
const id = new URLSearchParams(location.search).get("id");
if(!id){
    document.getElementById("view").innerHTML="âŒ ìƒí’ˆ ID ì—†ìŒ";
    throw new Error("ID ì—†ìŒ");
}

// ==========================================================
// ğŸ”¥ ìƒí’ˆ ìƒì„¸ ë¡œë”© (400 ë¬¸ì œ í•´ê²°: JS SDK ê¸°ë°˜)
// ==========================================================
async function loadProduct(){
    const { data, error } = await supabase
        .from("products")
        .select("*")
        .eq("id", id)
        .single(); // â† ì—¬ê¸° ë•Œë¬¸ì— 400 ì‚¬ë¼ì§

    if(error || !data){
        document.getElementById("view").innerHTML="âŒ ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŒ";
        return;
    }

    document.getElementById("view").innerHTML = `
        <div class="box">
            <img src="${data.images ?? 'https://placehold.co/800x400?text=No+Image'}">
            <h2>${data.title}</h2>
            <p>${data.description ?? ""}</p>

            <p><span class="label">ì‹œì‘ê°€:</span> ${data.price_start?.toLocaleString()}ì›</p>
            <p><span class="label">ì¢…ë£Œê°€:</span> ${data.price_end?.toLocaleString()}ì›</p>
            <p><span class="label">ì¦‰ì‹œêµ¬ë§¤:</span> ${data.buy_now?.toLocaleString()}ì›</p>

            <div class="btn" onclick="alert('ğŸš§ ì…ì°° ê¸°ëŠ¥ ê³§ ì—°ê²°ë¨')">ğŸ’° ì…ì°°í•˜ê¸°</div>
            <div class="btn" onclick="alert('ğŸš§ ì¦‰ì‹œêµ¬ë§¤ ì‹œìŠ¤í…œ ë‹¤ìŒ ë‹¨ê³„')">âš¡ ì¦‰ì‹œ êµ¬ë§¤</div>
        </div>
    `;
}

loadProduct(); // ğŸš€ ì‹¤í–‰
</script>
</body>
</html>
